{% extends 'baseTemplate.html' %} {% block title %}Compteurs{% endblock %} {% block content %}
<div class="text-center">
	<h1><a class="counter-link" href="{% url 'home' %}">SeumBook™</a></h1>
</div>
<div class="container-fluid">
	<div class="row" id="my-counter">
		<div class="col-sm-12">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<a class="counter-link" href="{% url 'counter' id_counter=myCounter.id %}">
						<h2 class="panel-title"><b>{{ myCounter.trigramme }}</b> <small>{{ myCounter.name }}</small>
							{% if not myCounter.lastReset.noSeum %}<span class="pull-right badge">{{ myCounter.seumCount }}</span>{% endif %}
						</h2>
					</a>
				</div>
				<div class="seum-counter panel-body" id="container{{myCounter.id}}" style="height:125px">
					{% if myCounter.lastReset.noSeum %}
					<strong>N'a pas encore eu le seum.</strong>
					<br> {% else %}
					<strong>
						{% if myCounter.lastReset.selfSeum %}
						J'ai eu le seum il y a {{ myCounter.lastReset.formatted_delta }}.
						{% else %}
						{{myCounter.lastReset.who.trigramme}} m'a foutu le seum il y a {{ myCounter.lastReset.formatted_delta }}.
						{% endif %}
					</strong>
					<br> {% endif %}

					<p>{{ myCounter.lastReset.reason }}</p>
					<div class="text-center" id="button{{myCounter.id}}">
						<button class="btn btn-default btn-danger" type="button" onclick="revealSeumForm({{myCounter.id}})">Remettre à zéro</button>
					</div>
					<form style="display:none" id="counter{{myCounter.id}}" action="{% url 'reset-counter' %}" method="post">
						{% csrf_token %}
						<div class="form-group">
							<label for="reason">Motif du seum :</label>
							<input id="reason{{myCounter.id}}" type="text" class="form-control" name="reason"></input>
						</div>
						<input type="hidden" name="counter" value="{{myCounter.id}}"></input>
						<input type="hidden" name="redirect" value="{% url 'home' %}"></input>
						<input type="hidden" name="who" value="{{myCounter.id}}"></input>
						<div class="text-center">
							<button type="submit" class="btn btn-default btn-success">J'ai le seum</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		{% for counter in counters %} {% if chooseCounter or not counter.id == myCounter.id %}
		<div class="col-md-3 col-sm-4 col-lg-2">
			<div class="panel panel-{{counter.CSSclass}}" style="opacity:{{counter.opacity}}">
				<div class="panel-heading">
					<a class="counter-link" href="{% url 'counter' id_counter=counter.id %}">
						<h2 class="panel-title"><b>{{ counter.trigramme }}</b> <small>{{ counter.name }}</small>
							{% if not counter.lastReset.noSeum %}<span class="pull-right badge">{{ counter.seumCount }}</span>{% endif %}
						</h2>
					</a>
				</div>
				<div class="seum-counter panel-body">
					{% if counter.lastReset.noSeum %}
					<strong>N'a pas encore eu le seum.</strong>
					<br> {% else %}
					<strong>
					{% if counter.lastReset.selfSeum %}
						A eu le seum il y a {{ counter.lastReset.formatted_delta }}.
					{% else %}
						{{ counter.lastReset.who.trigramme }} lui a foutu le seum il y a {{ counter.lastReset.formatted_delta }}.
					{% endif %}
					</strong>
					<br> {% endif %}

					<p>{{ counter.lastReset.reason }}</p>
				</div>
			</div>
		</div>
		{% endif %} {% endfor %}
	</div>
	<div class="row">
		<div class="col-sm-12">
			<div class="panel panel-info">
				<div class="panel-heading">
					<h2 class="panel-title">Timeline des 24 heures du seum</h2>
				</div>
				<div class="panel-body timeline graphs">
					{% if noTimeline %}
					<div class="text-center text-muted">
						<p>Pas de seum dans les dernières 24 heures...</p>
					</div>
					{% else %} {{ line_chart.as_html }} {% endif %}
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<div class="panel panel-info">
				<div class="panel-heading">
					<h2 class="panel-title">Graphe des jours sans seum</h2>
				</div>
				<div class="panel-body graphs">
					{% if noGraph %}
					<div class="text-center text-muted">
						<p>Personne n'a le seum...</p>
					</div>
					{% else %} {{ col_chart.as_html }} {% endif %}
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<div class="panel panel-info">
				<div class="panel-heading">
					<h2 class="panel-title">Meilleurs seumeurs</h2>
				</div>
				<div class="panel-body graphs">
					{% if noBestSeum %}
					<div class="text-center text-muted">
						<p>Personne n'a eu le seum...</p>
					</div>
					{% else %} {{ best_chart.as_html }} {% endif %}
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<div class="panel panel-info">
				<div class="panel-heading">
					<h2 class="panel-title">Activité seumesque</h2>
				</div>
				<div class="panel-body graphs">
					{% if noSeumActivity %}
					<div class="text-center text-muted">
						<p>Personne n'a eu le seum...</p>
					</div>
					{% else %} {{ activity_chart.as_html }} {% endif %}
				</div>
			</div>
		</div>
	</div>
</div>
<div class="row text-center">
	<a href="{% url 'logout' %}" class="btn btn-danger">Se déconnecter</a>
	<a href="{% url 'password_change' %}" class="btn btn-warning">Changer de mot de passe</a>
</div>
{% endblock %}
